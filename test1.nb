(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     38933,        960]
NotebookOptionsPosition[     37153,        901]
NotebookOutlinePosition[     37814,        922]
CellTagsIndexPosition[     37771,        919]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "CONSTANTS", " ", "AND", " ", "SIMPLE", " ", "FUNCTIONS", " ", "USED"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "Convection", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cp", " ", "=", "29.3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"J", "/", " ", "mol"}], " ", "K"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wind", " ", "=", " ", "1"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"m", "/", "s"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"original", " ", "data", " ", "tissue", " ", 
      RowBox[{"density", ":", "\[IndentingNewLine]", 
       RowBox[{"1", " ", 
        RowBox[{"kg", " ", "/", "l"}]}]}]}], " ", "=", "  ", 
     RowBox[{
      RowBox[{"1", " ", 
       RowBox[{"kg", "/", 
        RowBox[{"dm", "^", "3"}]}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{"1000", 
        RowBox[{"g", "/", 
         RowBox[{"dm", "^", "3"}]}]}], " ", "=", " ", 
       RowBox[{
        RowBox[{"1000", " ", 
         RowBox[{"g", "/", " ", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "3"}], ")"}]}]}], " ", 
         RowBox[{"m", "^", "3"}]}], "  ", "=", " ", 
        RowBox[{"1", " ", 
         RowBox[{"10", "^", "6"}], " ", 
         RowBox[{"g", "/", 
          RowBox[{"m", "^", "3"}]}]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]", " ", "=", " ", 
     RowBox[{"10", "^", 
      RowBox[{"(", "6", ")"}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"g", "/", 
     RowBox[{"m", "^", "3"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ksth", " ", "=", 
     RowBox[{"0.05", "*", " ", "cp"}]}], " ", 
    RowBox[{"(*", 
     RowBox[{"this", " ", "is", " ", "tissue", " ", 
      RowBox[{"conductance", ".", " ", "A"}], " ", "sleeping", " ", "bag", 
      " ", "has", " ", "0.05"}], " ", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"2.092", " ", 
     RowBox[{"10", " ", "^", 
      RowBox[{"(", 
       RowBox[{"-", "12"}], ")"}]}]}], "*)"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"5", " ", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "7"}], ")"}]}], " ", 
      RowBox[{"cal", "/", "s"}], " ", "C", " ", "mm2"}], " ", "=", " ", 
     RowBox[{"4.184", " ", "*", "5", " ", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "7"}], ")"}]}], " ", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "6"}], ")"}]}], " ", 
      RowBox[{"W", "/", "C"}], " ", "m2"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s", " ", "=", " ", "3.3472"}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"specific", " ", "heat", " ", "capacity"}], ",", " ", 
     RowBox[{
      RowBox[{"0.8", " ", 
       RowBox[{"cal", " ", "/", "g"}], " ", "C"}], " ", "=", " ", 
      RowBox[{"0.8", "*", "4.184", " ", 
       RowBox[{"J", "/", "g"}], " ", "C"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]", "=", 
     RowBox[{"5.67", " ", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "8"}], ")"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"W", "/", "m2"}], " ", "K4"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e", " ", "=", " ", "0.04184"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"energy", " ", "per", " ", 
      RowBox[{"contraction", ":", " ", 
       RowBox[{"0.01", " ", 
        RowBox[{"cal", "/", "g"}]}]}]}], " ", "=", " ", 
     RowBox[{"0.01", "*", "4.184", " ", 
      RowBox[{"j", "/", "g"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Kv", "[", "z_", "]"}], ":=", " ", 
     RowBox[{"cp", " ", "1.4", " ", "0.135", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"wind", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z", "/", "\[Delta]"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}]}]}], "]"}]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"J", "/", "mol"}], " ", "K", " ", "x", " ", 
      RowBox[{"mol", " ", "/", "m2"}], " ", "s"}], " ", "*)"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{",", " ", 
     RowBox[{
      RowBox[{"Conversion", ":", " ", 
       RowBox[{"1", " ", "cal"}]}], " ", "=", " ", 
      RowBox[{"4.184", " ", "J"}]}], ",", " ", 
     RowBox[{
      RowBox[{"1", "m2"}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1000", " ", "mm"}], ")"}], "^", "2"}], " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"10", "^", "6"}], " ", "mm2", " ", "thus", " ", "1", " ", 
         "mm2"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "6"}], ")"}]}], " ", "m2"}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aw", " ", "=", " ", "0.25"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"something", " ", "per", " ", "second"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "T_", "]"}], ":=", " ", 
     RowBox[{"aw", " ", "T"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Start", " ", "from", " ", "radius", " ", "calculating", " ", "it", " ", 
     "is", " ", "easier"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rad", "[", "z_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3.", " ", 
        RowBox[{"z", "/", 
         RowBox[{"(", 
          RowBox[{"4", " ", "\[Pi]", " ", "\[Delta]"}], ")"}]}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "3"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"As", "[", "z_", "]"}], ":=", " ", 
     RowBox[{"3.", " ", "\[Pi]", " ", 
      RowBox[{
       RowBox[{"rad", "[", "z", "]"}], "^", "2"}]}]}], " ", 
    RowBox[{"(*", " ", "m2", "*)"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Total", " ", "surface", " ", "area"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ath", "[", "z_", "]"}], ":=", " ", 
     RowBox[{"2.", " ", "\[Pi]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rad", "[", "z", "]"}], ")"}], "^", "2"}]}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Thoracic", " ", "surface", " ", "area"}], ",", " ", 
     RowBox[{
      RowBox[{"circle", " ", "surface"}], " ", "=", "  ", 
      RowBox[{"\[Pi]", " ", 
       RowBox[{"r", "^", "2"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"sphere", " ", "surface"}], " ", "=", " ", 
      RowBox[{"4", " ", "\[Pi]", " ", 
       RowBox[{"r", "^", "2"}]}]}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.6489895655126266`*^9, 3.6489895742328887`*^9}, {
   3.6489896316346107`*^9, 3.6489897659986415`*^9}, {3.6489898276304903`*^9, 
   3.6489898842131877`*^9}, {3.6489899550753136`*^9, 
   3.6489900486991224`*^9}, {3.6489903861673317`*^9, 3.648990489301426*^9}, {
   3.6489905197223377`*^9, 3.648990674816991*^9}, {3.648990769220823*^9, 
   3.6489907713608875`*^9}, {3.648990857224463*^9, 3.6489908711548805`*^9}, {
   3.649010820052123*^9, 3.6490108212032385`*^9}, {3.649013100154028*^9, 
   3.6490131162376275`*^9}, {3.6490147096671925`*^9, 
   3.6490147685960855`*^9}, {3.649014799299155*^9, 3.6490149240436287`*^9}, {
   3.64901496756498*^9, 3.6490150266728907`*^9}, {3.6490150753307557`*^9, 
   3.6490150870489273`*^9}, {3.649069990027604*^9, 3.649070002883889*^9}, {
   3.649070044064007*^9, 3.649070093489949*^9}, {3.6490702188564844`*^9, 
   3.649070258184417*^9}, {3.6490721458401685`*^9, 3.6490722610756907`*^9}, {
   3.6490739276073275`*^9, 3.6490739282343903`*^9}, {3.6490742891944823`*^9, 
   3.649074298905453*^9}, {3.6490843039611197`*^9, 3.6490843075634804`*^9}, {
   3.6490843842541485`*^9, 3.649084387531476*^9}, 3.6490845293336554`*^9, {
   3.649084636932414*^9, 3.649084639208641*^9}, {3.649086838353567*^9, 
   3.6490868443937483`*^9}, {3.6490869739476347`*^9, 3.649086991598164*^9}, {
   3.6490870339194336`*^9, 3.6490870694705*^9}, {3.649087493771512*^9, 
   3.649087500561716*^9}, 3.649110412828515*^9, {3.649111091910158*^9, 
   3.649111097807109*^9}, {3.649111155419386*^9, 3.64911118910065*^9}, 
   3.6491120928419704`*^9, 3.649112532555845*^9, 3.6491125709172287`*^9, 
   3.6491128400865297`*^9, {3.6491128821452084`*^9, 3.649112899633257*^9}, {
   3.649113048040862*^9, 3.6491130485400753`*^9}, 3.6491135782913713`*^9, {
   3.6491140396898017`*^9, 3.6491140401422133`*^9}, 3.6491141238227587`*^9, {
   3.649114358704382*^9, 3.6491143792189074`*^9}, {3.6491145487172537`*^9, 
   3.649114550105689*^9}, {3.649114673926064*^9, 3.6491146886372414`*^9}, {
   3.6491147288082714`*^9, 3.6491147442370667`*^9}, {3.6491147900564413`*^9, 
   3.6491148104149637`*^9}, {3.6491148518652267`*^9, 3.6491148520212307`*^9}, 
   3.649115142128084*^9, {3.649155713529217*^9, 3.6491557199097395`*^9}, {
   3.6491558488774195`*^9, 3.6491558494234304`*^9}, 3.649518144285654*^9, {
   3.6495182014299192`*^9, 3.649518201648325*^9}, {3.650115071299611*^9, 
   3.650115105215316*^9}, {3.6507248617414827`*^9, 3.6507248868379927`*^9}, {
   3.6553994035336437`*^9, 3.655399410557346*^9}, {3.6554072478320093`*^9, 
   3.655407250914317*^9}, {3.6554101536435704`*^9, 3.6554101572129273`*^9}, {
   3.6554101976789737`*^9, 3.6554102013593416`*^9}, {3.6563492357682123`*^9, 
   3.6563492658936605`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"for", " ", "plotting"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"th", " ", "=", " ", "2"}], ";", " ", 
   RowBox[{"asz", " ", "=", "16"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6554146126954403`*^9, 3.6554146185820293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"SR", "[", "t", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{"6", "*", "3600"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.656350487715287*^9, 3.656350500106103*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwV0/k71AkAx3FXNiWFHEUadKyjKLfY+ezYsTXN2JKtTe0WcoxWjhRJxjEj
ZiTGV9g8a1WOQkW6kHNcNXJ9Rw+bFrUxlY1m3aptf3g/r7/gbegd7O6rICcn
x/rS/yYPV1eWvHSipgszU92pi9945jE09GPXwmcgTtlT2k8dsZExRjimsH/0
/LyhVErdFPe9fzPHEflb+TuXSOeobYWhU/c4DBwYHfp6ZkwFOQ8Ta25xPFHh
orpmYmwNFFzUKaWcQPw1aZj+bswE98737b3BicJ0m3nHmzEH7LITdE7nCmD6
0Zc29JmBF7cd+TYJBLza8z4lqHlgzuJSK037MrKtXfim0Z7o9yw7tKCXD01a
PaWw6ihOmxktSIOvQYNtaF244AMvzhOZ2fJiOMX/MOgT7w/npWNnsjJLkPs2
e/DGbCAGDLKKdF7ehA15TcvL6gR8DjtnTe0ox7lntaFv+kPgGBJ5UzpagXPc
lH8PRYch2SAoJUxQiaz+USOhdjg4aovaBe730Fxkol/Uewr76R5TXgv3IbzL
LJeFRYB85Brb1voQ4U771dfbnMHjrg/dTYJqhBwf11/5Pgr5pgERu7Y9gsqA
r8hWEI31LRHtkfO1eNAgsnVmxIDqUWyX414PRakS/exbDmivh4ceOzSgQqS1
UvwsFnH0yPEW/UZMjAV319yNg+VOmXHSRCMWS6u82rnxuHO82tKgrwkZZZEH
6L4JKNwe4H+mVIQZ1ma9QVsu+lpC5fNimhHYmGt9QImH/rNtoTneLQg4ybuD
lzwwSUXVg3atsBL9Iud6JxEZrJTo8XVt4O8tqagizkObCN3DlGvHeEVtlXpY
EpbF7HAL6W2HYWVjGhfJ6E5yN2I/eIzBSQexH4UPFTs3yubUJ2B35kuOTfJx
rqIw7tYRMRTiuqzptQKI3JgPVV06sDE4bI7ITUF0at9aC52n0P2olCL36wV8
9b7MfdPHpyBal3H/ZKZCUcauHOntxNA2eUaPwUWs826osd7XBYeQWt+Sdxdh
fCic793chdRTEbI53zQMF6wZ/2DRjVGFpXrmT9OgEvd3VdDVbiRudZ/Soqaj
s/FIVcfqHpiJOPMTZelg7Re7pcX04P71gtcHtYSwiTri5jzZg+QtPF4UTwjJ
+1cjzMO9oMn/vNzkHyE0xbrXv23uhTxVt6bNIwPV9icHKHYklPUurKeIMqA3
U/eHdz6JD67z7CXmBISaFG3nqyQSDGw9JFsILLOMFegUkNCaDv2mwILAfABO
i4tJ2BdINehWBAYG6nfb3ibBUeyv5joSyKltmFapI7Gi/v4KpV0EdBKbmOXP
SWx2OFWu4Ecg9Ypxo+AFiQeryi/3+BNQrkuw8xsiwRh7x7vCJjA942Kk94pE
UNYxT1oQgT62aIb7lkTl1D7F+HACmazmKz/Nk6BVbP9R/suHqoEbda0WSfQm
n6B2cwlwE3kXVnwicczrhkl+IoHwOnpko7wESauMPoFPwGNbC8tcRYLOE+pF
sekExKxNTcrLJfByZaXvySDwXWCi/bCqBLJ1yWcpmQSsr7oaX1olgXaH3J76
bAKldYXZIRoSFF9zckz7jcCG58pqu1dL4BAdueFoLoHcWb+EjdoSPNlXqWb5
OwFNrdbZzzoSHDabmP2cR+A/hVpPhw==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 21600}, {0., 1319.9999730612244`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{3.6563505005904274`*^9, 3.656351423956352*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SR", "  ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "/", 
      RowBox[{"(", 
       RowBox[{"6", "*", "3600"}], ")"}]}], " ", "*", " ", "1320."}], " ", 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Te", " ", "=", " ", 
    RowBox[{
     RowBox[{"#2", " ", "+", " ", 
      RowBox[{"0", " ", 
       RowBox[{"#1", "/", 
        RowBox[{"(", 
         RowBox[{"6", "*", "3600."}], ")"}]}]}]}], " ", "&"}]}], ";"}], 
  "  "}]}], "Input",
 CellChangeTimes->{{3.656349343338623*^9, 3.6563495146377463`*^9}, {
   3.6563505853884554`*^9, 3.656350587435355*^9}, {3.656351058954611*^9, 
   3.6563510806736927`*^9}, 3.6563512039330835`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "function", " ", "is", " ", "for", " ", "the", " ", "change", 
    " ", "in", " ", "thoracic", " ", 
    RowBox[{"(", 
     RowBox[{"and", " ", "surface"}], ")"}], " ", "temperature"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"changeTth", "[", 
     RowBox[{
     "z_", ",", " ", "rK1_", ",", " ", "rK2_", ",", "minT_", ",", "free_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"maxt", " ", "=", " ", 
         RowBox[{"6", "*", "3600"}]}], ",", " ", 
        RowBox[{"\[CurlyEpsilon]", "=", " ", "0.95"}], ",", " ", 
        RowBox[{"r3", " ", "=", "0.5"}], ",", "sol"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"free", " ", "\[Equal]", " ", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Tth", "'"}], "[", "t", "]"}], " ", "\[Equal]", " ", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"s", " ", 
                   RowBox[{"z", "/", "2"}]}], ")"}]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.", " ", "*", 
                   RowBox[{"z", "/", "2"}], " ", "e"}], "   ", "+", "  ", 
                  RowBox[{
                   RowBox[{"Ath", "[", "z", "]"}], " ", "rK1", " ", "Ksth", 
                   " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ts", "[", "t", "]"}], " ", "-", " ", 
                    RowBox[{"Tth", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], 
              ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Ts", "'"}], "[", "t", "]"}], " ", "\[Equal]", "  ", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"s", " ", 
                   RowBox[{"z", "/", "2"}]}], ")"}]}], " ", "*", 
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", " ", 
                    RowBox[{"Ath", "[", "z", "]"}]}], " ", "rK1", " ", "Ksth",
                    " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ts", "[", "t", "]"}], " ", "-", " ", 
                    RowBox[{"Tth", "[", "t", "]"}]}], ")"}]}], " ", "+", " ", 
                  RowBox[{
                   RowBox[{"As", "[", "z", "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", " ", "rK2"}], "  ", "0.05", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ts", "[", "t", "]"}], "-", " ", 
                    RowBox[{"Te", "[", 
                    RowBox[{"t", ",", "minT"}], "]"}]}], ")"}], "^", 
                    RowBox[{"(", "1.25", ")"}]}], " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"z", "/", "\[Delta]"}], ")"}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "12"}], ")"}]}]}], " ", "-", " ", 
                    RowBox[{"\[Sigma]", " ", "\[CurlyEpsilon]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"273", " ", "+", " ", 
                    RowBox[{"Ts", "[", "t", "]"}]}], ")"}], "^", "4"}]}], " ",
                     "+", " ", 
                    RowBox[{"\[Sigma]", " ", "\[CurlyEpsilon]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"273", " ", "+", " ", 
                    RowBox[{"Te", "[", 
                    RowBox[{"t", ",", "minT"}], "]"}]}], ")"}], "^", "4"}]}], 
                    " ", "+", " ", 
                    RowBox[{"r3", " ", 
                    RowBox[{"SR", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
              " ", ",", 
              RowBox[{
               RowBox[{"Tth", "[", "0", "]"}], "\[Equal]", 
               RowBox[{"Ts", "[", "0", "]"}], "\[Equal]", "minT"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"Tth", ",", "Ts"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "maxt"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Tth", "'"}], "[", "t", "]"}], " ", "\[Equal]", " ", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"s", " ", 
                   RowBox[{"z", "/", "2"}]}], ")"}]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.", " ", "*", " ", 
                   RowBox[{"z", "/", "2"}], " ", "e"}], "   ", "+", "  ", 
                  RowBox[{
                   RowBox[{"Ath", "[", "z", "]"}], " ", "rK1", " ", "Ksth", 
                   " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ts", "[", "t", "]"}], " ", "-", " ", 
                    RowBox[{"Tth", "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], 
              ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Ts", "'"}], "[", "t", "]"}], " ", "\[Equal]", "  ", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"s", " ", 
                   RowBox[{"z", "/", "2"}]}], ")"}]}], " ", "*", " ", 
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", " ", 
                    RowBox[{"Ath", "[", "z", "]"}]}], " ", "rK1", " ", "Ksth",
                    " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ts", "[", "t", "]"}], " ", "-", " ", 
                    RowBox[{"Tth", "[", "t", "]"}]}], ")"}]}], " ", "+", " ", 
                  RowBox[{
                   RowBox[{"As", "[", "z", "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", " ", "rK2"}], "  ", "cp", " ", "1.4", " ", 
                    "0.135", " ", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"wind", "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z", "/", "\[Delta]"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", "3"}], ")"}]}]}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ts", "[", "t", "]"}], "-", " ", 
                    RowBox[{"Te", "[", 
                    RowBox[{"t", ",", "minT"}], "]"}]}], ")"}]}], " ", "-", 
                    " ", 
                    RowBox[{"\[Sigma]", " ", "\[CurlyEpsilon]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"273", " ", "+", " ", 
                    RowBox[{"Ts", "[", "t", "]"}]}], ")"}], "^", "4"}]}], " ",
                     "+", " ", 
                    RowBox[{"\[Sigma]", " ", "\[CurlyEpsilon]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"273", " ", "+", " ", 
                    RowBox[{"Te", "[", 
                    RowBox[{"t", ",", "minT"}], "]"}]}], ")"}], "^", "4"}]}], 
                    " ", "+", " ", 
                    RowBox[{"r3", " ", 
                    RowBox[{"SR", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
              " ", ",", 
              RowBox[{
               RowBox[{"Tth", "[", "0", "]"}], "\[Equal]", 
               RowBox[{"Ts", "[", "0", "]"}], "\[Equal]", "minT"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"Tth", ",", "Ts"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "maxt"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "sol"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.656349591572213*^9, 3.6563496613075194`*^9}, {
   3.6563496997125177`*^9, 3.656349759744546*^9}, {3.6563499703431187`*^9, 
   3.6563501466013093`*^9}, {3.6563502436025352`*^9, 3.6563503294562626`*^9}, 
   3.656350446855383*^9, {3.656350725584032*^9, 3.6563507259590654`*^9}, {
   3.656350899647497*^9, 3.6563509015468454`*^9}, {3.6563509452206125`*^9, 
   3.6563509503633437`*^9}, {3.6563511389790583`*^9, 
   3.6563511885891037`*^9}, {3.656351219980115*^9, 3.656351220714492*^9}, {
   3.6563513139500737`*^9, 3.656351318434533*^9}, {3.6563513513834805`*^9, 
   3.6563513660962377`*^9}, {3.656351499410438*^9, 3.6563515025823603`*^9}, {
   3.656351633834056*^9, 3.6563516443967147`*^9}, {3.65635168638161*^9, 
   3.656351698104989*^9}, 3.65635173323668*^9, {3.6563519648434324`*^9, 
   3.656351968437228*^9}, {3.65635208110633*^9, 3.6563520845282516`*^9}, {
   3.6563525235074615`*^9, 3.656352538502657*^9}, {3.6563525850945015`*^9, 
   3.656352656971831*^9}, {3.656353209433687*^9, 3.656353210121196*^9}, {
   3.6563757853953743`*^9, 3.656375789332162*^9}}],

Cell[BoxData["sol"], "Input",
 CellChangeTimes->{{3.656351727439729*^9, 3.6563517276897335`*^9}}],

Cell[BoxData["out"], "Input",
 CellChangeTimes->{{3.6563516215839195`*^9, 3.656351622005829*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tt", " ", "=", 
  RowBox[{"changeTth", "[", 
   RowBox[{"1", ",", "1", ",", "0", ",", "15", ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6563516706158333`*^9, 3.6563516713814096`*^9}, 
   3.6563517211427813`*^9, {3.6563518542482805`*^9, 3.656351855404543*^9}, {
   3.65635200470335*^9, 3.656352025375493*^9}, {3.6563521231693554`*^9, 
   3.6563521493572426`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Tth", "\[Rule]", 
     TagBox[
      RowBox[{"InterpolatingFunction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0.`", ",", "21600.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
       "]"}],
      False,
      Editable->False]}], ",", 
    RowBox[{"Ts", "\[Rule]", 
     TagBox[
      RowBox[{"InterpolatingFunction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0.`", ",", "21600.`"}], "}"}], "}"}], ",", "\<\"<>\"\>"}], 
       "]"}],
      False,
      Editable->False]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6563516923817015`*^9, 3.6563517215490303`*^9}, 
   3.656351800031788*^9, {3.6563518494200373`*^9, 3.6563518829048424`*^9}, {
   3.656351993359396*^9, 3.6563520265785947`*^9}, {3.6563521173567686`*^9, 
   3.656352149575936*^9}, 3.6563524037090564`*^9, 3.6563750935846863`*^9}]
}, Open  ]],

Cell[BoxData["tt"], "Input",
 CellChangeTimes->{{3.656352186029563*^9, 3.656352198998508*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Tth", "[", 
   RowBox[{"6", "*", "3600"}], "]"}], "/.", 
  RowBox[{"tt", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6563532567447615`*^9, 3.6563532701199913`*^9}}],

Cell[BoxData["2.5864033055652618`"], "Output",
 CellChangeTimes->{3.656353270448081*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tt", " ", "=", 
   RowBox[{"changeTth", "[", 
    RowBox[{"0.01", ",", "0.1", ",", "20", ",", "0", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"Tth", "[", "t", "]"}], "/.", " ", 
     RowBox[{"tt", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", " ", "0", " ", ",", 
     RowBox[{"6", "*", "3600"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "100"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6563524148185563`*^9, 3.656352575906911*^9}, {
  3.6563526643625813`*^9, 3.6563527445823135`*^9}, {3.6563528384372244`*^9, 
  3.656352878953375*^9}, {3.6563531900428114`*^9, 3.656353243265308*^9}, {
  3.6563750998846655`*^9, 3.656375120042843*^9}, {3.6563769850480223`*^9, 
  3.656376994502986*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
jsH/AAWlg70=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 21600}, {0, 100}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], Automatic}]], "Output",
 CellChangeTimes->{{3.6563751129653325`*^9, 3.656375120536791*^9}, {
  3.656376985472313*^9, 3.656376994707103*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"Background", "\[Rule]", " ", "White"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6563760707022686`*^9, 3.6563761655453897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "finds", " ", "an", " ", "interval", " ", "of", " ", 
     "temperature", " ", "such", " ", "that", " ", "at", " ", "maxt"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"f", 
      RowBox[{"(", "T1", ")"}]}], " ", "<", " ", 
     RowBox[{"Tw", " ", "and", " ", "f", 
      RowBox[{"(", "T2", ")"}]}], ">", "Tw"}], ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "condition", " ", "is", " ", "that", " ", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"f", 
         RowBox[{"(", "t1", ")"}]}], " ", "-", " ", 
        RowBox[{"f", 
         RowBox[{"(", "t2", ")"}]}]}], "]"}]}], " ", "<", " ", "0.01"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"findTmin", "[", 
     RowBox[{"z_", ",", " ", "rK1_", ",", " ", "rK2_", ",", " ", "free_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Tw", " ", "=", " ", 
         RowBox[{"28", " ", "+", " ", 
          RowBox[{"0.75", " ", "z"}]}]}], ",", "T1", ",", "T2", ",", " ", 
        "Tmid", ",", 
        RowBox[{"maxt", " ", "=", " ", 
         RowBox[{"6", "*", "3600"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T1", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"T2", " ", "=", " ", "100"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Tf1", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Tf2", " ", "=", " ", "100"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Tmid", " ", "=", " ", "T1"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sol", "  ", "=", " ", 
        RowBox[{"changeTth", "[", 
         RowBox[{
         "z", ",", "rK1", ",", " ", "rK2", ",", " ", "T1", ",", " ", "free"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Tf1", " ", "=", " ", 
        RowBox[{
         RowBox[{"Tth", "[", "maxt", "]"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Tf1", " ", ">", " ", "Tw"}], ",", " ", 
         RowBox[{"Goto", "[", "end", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Tf1", " ", "-", "Tf2"}], "]"}], " ", ">", " ", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "2"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Tmid", " ", "=", " ", 
           RowBox[{"T1", " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"T2", " ", "-", " ", "T1"}], " ", ")"}], "/", "2"}]}]}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"sol", "  ", "=", " ", 
           RowBox[{"changeTth", "[", 
            RowBox[{
            "z", ",", "rK1", ",", " ", "rK2", ",", " ", "Tmid", ",", " ", 
             "free"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Tfmid", " ", "=", " ", 
           RowBox[{
            RowBox[{"Tth", "[", "maxt", "]"}], "/.", 
            RowBox[{"sol", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Tfmid", " ", "<", " ", "Tw"}], ",", 
            RowBox[{
             RowBox[{"Tf1", " ", "=", " ", "Tfmid"}], ";", 
             RowBox[{"T1", " ", "=", " ", "Tmid"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Tfmid", " ", ">", " ", "Tw"}], ",", 
            RowBox[{
             RowBox[{"Tf2", " ", "=", " ", "Tfmid"}], ";", 
             RowBox[{"T2", " ", "=", " ", "Tmid"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Tfmid", " ", "\[Equal]", " ", "Tw"}], ",", 
            RowBox[{
             RowBox[{"T1", " ", "=", " ", "Tmid"}], ";", 
             RowBox[{"Goto", "[", "end", "]"}]}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "end", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"N", "@", 
        RowBox[{"{", 
         RowBox[{"z", ",", "T1"}], "}"}]}]}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.656375139532367*^9, 3.6563752041501355`*^9}, {
  3.656375254272182*^9, 3.6563753261226826`*^9}, {3.6563757050945425`*^9, 
  3.6563759530009775`*^9}, {3.656376174374511*^9, 3.6563765253564606`*^9}, {
  3.6563765907349005`*^9, 3.6563765910321307`*^9}, {3.656376722473751*^9, 
  3.6563767653034906`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["Tf1"], "Input",
 CellChangeTimes->{{3.6563766159989433`*^9, 3.656376675614024*^9}, {
  3.656377111614125*^9, 3.6563771162972775`*^9}}],

Cell[BoxData["28.74790815047042`"], "Output",
 CellChangeTimes->{{3.656376618413637*^9, 3.6563766759112167`*^9}, {
  3.656377112095256*^9, 3.65637711711559*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Tf2"], "Input",
 CellChangeTimes->{{3.6563771180350523`*^9, 3.6563771190427704`*^9}}],

Cell[BoxData["28.753664582207268`"], "Output",
 CellChangeTimes->{3.6563771193689833`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"findTmin", "[", 
  RowBox[{"1", ",", "0.1", ",", "10", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.656376574343278*^9, 3.656376608373955*^9}, {
  3.6563766784083967`*^9, 3.656376683325488*^9}, {3.6563767722362986`*^9, 
  3.656376780121812*^9}, {3.6563769772719307`*^9, 3.6563770031965647`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", "16.76025390625`"}], "}"}]], "Output",
 CellChangeTimes->{{3.6563765844194164`*^9, 3.6563766129261804`*^9}, {
  3.656376678845708*^9, 3.656376683770914*^9}, {3.6563767697618093`*^9, 
  3.6563767803399687`*^9}, {3.6563769777072535`*^9, 3.6563770034997883`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.656351857842019*^9, 3.6563518719360075`*^9}, {
   3.6563519031238537`*^9, 3.6563519084677324`*^9}, {3.656351999781356*^9, 
   3.656352018953535*^9}, 3.6563521534666414`*^9, {3.656352724894556*^9, 
   3.656352752176221*^9}, 3.6563752966939955`*^9}],

Cell[BoxData["20.865270080348942`"], "Output",
 CellChangeTimes->{{3.6563518633577137`*^9, 3.6563518722953324`*^9}, {
  3.6563519035457363`*^9, 3.6563519100770683`*^9}, {3.6563519973750725`*^9, 
  3.6563520275160885`*^9}, {3.656352119966178*^9, 3.656352153841635*^9}, {
  3.6563527178319645`*^9, 3.656352752613664*^9}}]
}, Open  ]]
},
WindowSize->{1264, 593},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Background->GrayLevel[1],
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, WindowSize -> {707, 466}, 
  WindowMargins -> {{0, Automatic}, {Automatic, 0}}, Visible -> False, 
  FrontEndVersion -> "9.0 for Microsoft Windows (64-bit) (January 25, 2013)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 9664, 235, 552, "Input"],
Cell[10224, 257, 295, 7, 52, "Input"],
Cell[CellGroupData[{
Cell[10544, 268, 264, 7, 31, "Input"],
Cell[10811, 277, 2137, 42, 239, "Output"]
}, Open  ]],
Cell[12963, 322, 712, 21, 52, "Input"],
Cell[13678, 345, 9706, 219, 352, "Input"],
Cell[23387, 566, 97, 1, 31, "Input"],
Cell[23487, 569, 97, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[23609, 574, 395, 7, 31, "Input"],
Cell[24007, 583, 950, 27, 31, "Output"]
}, Open  ]],
Cell[24972, 613, 94, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[25091, 618, 230, 6, 31, "Input"],
Cell[25324, 626, 88, 1, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25449, 632, 947, 23, 52, "Input"],
Cell[26399, 657, 3790, 69, 252, "Output"]
}, Open  ]],
Cell[30204, 729, 245, 5, 31, "Input"],
Cell[30452, 736, 4788, 111, 532, "Input"],
Cell[CellGroupData[{
Cell[35265, 851, 148, 2, 31, "Input"],
Cell[35416, 855, 161, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35614, 862, 99, 1, 31, "Input"],
Cell[35716, 865, 90, 1, 87, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35843, 871, 325, 5, 31, "Input"],
Cell[36171, 878, 311, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36519, 888, 296, 4, 31, "Input"],
Cell[36818, 894, 319, 4, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
